{% extends 'base.html' %}
{% load static %}
{% load utils %}

{% block title %}
<title>{{ film.movie_name }} Preview</title>

<style>
  .results { font-family: 'Lato', sans-serif; }
  .norounds { border-radius: 0px; }
  .imagestyle {
    box-shadow: 0 4px 8px rgba(185,65,223,0.88),
                0 6px 20px rgba(4,47,243,0.99);
  }
</style>
{% endblock title %}

{% block content %}
<div class="container" id="movie-content">
  <div class="row">

    <!-- Poster -->
    <div class="col-md-4 d-flex justify-content-center">
      <div class="card text-center border-0 bgdark" style="width: 18rem;">
        <img class="card-img-top imagestyle" src="{{ film.url }}" alt="Movie Poster">
        <div class="card-body">
          <!-- ✅ Fixed URL -->
          <a href="{% url 'show select' %}?movie={{ film.id }}&date={{ "%Y-%m-%d"|cdateadd:"1" }}" 
             class="btn btn-warning">
            Get Tickets
          </a>
        </div>
      </div>
    </div>

    <!-- Movie Info -->
    <div class="col-md-8">
      <h1>{{ film.movie_name }}</h1>
      <h2>{{ film.movie_year }}</h2>
      <h3>{{ film.movie_lang }} | {{ film.movie_genre }}</h3>

      <p>
        {% if showtimes %}
          <em>Available Times:</em><br>

          {% for show in showtimes %}
            <!-- ✅ Fixed URL with correct show id -->
            <a href="{% url 'show select' %}?show_id={{ show.id }}&date={{ "%Y-%m-%d"|cdateadd:"1" }}" 
               class="btn btn-primary m-1">
              {{ show.showtime|tformat:"%I:%M %p" }}
            </a>
          {% endfor %}

        {% else %}
          <em>No shows available. Please check later.</em>
        {% endif %}
      </p>

      <p>{{ film.movie_plot }}</p>
    </div>

  </div>
</div>
{% endblock content %}
